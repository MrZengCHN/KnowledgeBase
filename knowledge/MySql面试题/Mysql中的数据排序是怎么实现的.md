MySQL 排序数据有两条路：**利用索引天然有序**，或者自己动手做 **filesort**。

如果 ORDER BY 的字段正好有索引，而且排序方向一致，MySQL 直接顺着 B+ 树叶子节点扫描就行，不用额外排序，效率非常高。

要是没命中索引，或者索引顺序不对，就得走 filesort 了。这时候 MySQL 会用 `sort_buffer` 这个内存缓冲区来排序。数据量小就在内存里搞定，数据量大塞不下就得借助磁盘做外部排序，用归并算法把小块排好序的数据合并成大文件。

内存排序还分**单路排序**和**双路排序**两种模式：

- 单路排序：把所有 SELECT 字段都放进 sort_buffer 排，排完直接返回
- 双路排序：只放排序字段和行 ID，排好序之后再回表取其他字段